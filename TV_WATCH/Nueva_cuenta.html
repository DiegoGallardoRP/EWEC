<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registrarse - Inflix</title>
    <style>
        .oculto {
            display: none;
        }
        .visible {
            display: block;
            color: red;
        }
    </style>
    <script src="./clases/Usuario.js"></script>
    <script>
        function cargarUsuarios() {
            let listaUsuarios = JSON.parse(localStorage.getItem("listaUsuarios")) || [];
            return listaUsuarios;
        }

        function guardarUsuario(usuario) {
            let listaUsuarios = cargarUsuarios();
            listaUsuarios.push(usuario);
            localStorage.setItem("listaUsuarios", JSON.stringify(listaUsuarios));
        }

        function enviarDatos() {
            let nombre = document.getElementById("nombre").value;
            let correo = document.getElementById("correo").value;
            let clave1 = document.getElementById("clave1").value;
            let clave2 = document.getElementById("clave2").value;

            if (clave1 !== clave2) {
                document.getElementById("error").className = "visible";
                return;
            }

            let listaUsuarios = cargarUsuarios();
            let usuarioExistente = listaUsuarios.find((usuario) => usuario.nombre === nombre || usuario.correo === correo);

            if (usuarioExistente) {
                alert("Este nombre de usuario o correo ya está registrado.");
            } else {
                let nuevoUsuario = new Usuario(
                    String(listaUsuarios.length + 1).padStart(4, "0"),
                    clave1,
                    nombre,
                    correo,
                    "N",
                    "A"  
                );
                guardarUsuario(nuevoUsuario);
                location.href = "Inicio_sesion.html";
            }
        }
    </script>
</head>
<body>
    <center>
        <h1>REGISTRATE</h1>
        <p>Por favor introduzca el usuario, la contraseña y el correo electrónico:</p>
        <input type="text" id="nombre" placeholder="Introduzca su nombre" /> </br>
        <input type="text" id="correo" placeholder="Introduzca su correo" /> </br>
        <input type="password" id="clave1" placeholder="Contraseña" /> </br>
        <input type="password" id="clave2" placeholder="Confirma contraseña" /> </br>
        <p id="error" class="oculto">El usuario y/o la clave son erroneos</p>
        <button type="button" onclick="enviarDatos()">Enviar</button>
    </center>
</body>
</html>